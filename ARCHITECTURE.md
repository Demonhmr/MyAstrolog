# üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ MyAstro Bot

## –û–±–∑–æ—Ä

**MyAstro Bot** ‚Äî Telegram-–±–æ—Ç –Ω–∞ Python, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â–∏–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∞—Å—Ç—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –º–µ—Å—è—Ü –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç–æ–¥–∞ *–õ—É–Ω–∞—Ä–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞*. –†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ **long polling**, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø—É–±–ª–∏—á–Ω–æ–≥–æ IP/–¥–æ–º–µ–Ω–∞.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
my_astro_bot/
‚îú‚îÄ‚îÄ bot/                        # Telegram-—É—Ä–æ–≤–µ–Ω—å
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, dispatcher, —Ä–æ—É—Ç–µ—Ä—ã, middleware
‚îÇ   ‚îî‚îÄ‚îÄ handlers/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ registration.py     # FSM-—Ñ–ª–æ—É —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞
‚îÇ
‚îú‚îÄ‚îÄ core/                       # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ astrology.py            # –†–∞—Å—á—ë—Ç –õ—É–Ω–∞—Ä–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞, –ø–æ–∑–∏—Ü–∏–∏ –ø–ª–∞–Ω–µ—Ç, —Ä–µ—Ç—Ä–æ–≥—Ä–∞–¥–Ω–æ—Å—Ç—å
‚îÇ   ‚îú‚îÄ‚îÄ calculator.py           # –ü–æ–¥—Å—á—ë—Ç –æ—á–∫–æ–≤ —ç–ª–µ–º–µ–Ω—Ç–æ–≤/–∫—Ä–µ—Å—Ç–æ–≤, –¥–æ–º–∏–Ω–∞–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ chart_generator.py      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PNG-–∫–∞—Ä—Ç—ã —á–µ—Ä–µ–∑ matplotlib
‚îÇ   ‚îú‚îÄ‚îÄ geocoder.py             # –ì–µ–æ–∫–æ–¥–∏–Ω–≥ –≥–æ—Ä–æ–¥–∞ ‚Üí –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã + —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å
‚îÇ   ‚îî‚îÄ‚îÄ interpretator.py        # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∞ –∏ LLM-–ø—Ä–æ–º—Ç–∞
‚îÇ
‚îú‚îÄ‚îÄ data/                       # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ interpretations/        # –¢–µ–∫—Å—Ç—ã –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–π (JSON)
‚îÇ   ‚îî‚îÄ‚îÄ prompts/                # –®–∞–±–ª–æ–Ω—ã –ø—Ä–æ–º—Ç–æ–≤ –¥–ª—è LLM
‚îÇ
‚îú‚îÄ‚îÄ .env                        # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å!)
‚îú‚îÄ‚îÄ .env.example                # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ requirements.txt            # Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

---

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –∏—Ö –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

### `bot/main.py` ‚Äî –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç `Bot` –∏ `Dispatcher` (aiogram 3.x)
- –ü–æ–¥–∫–ª—é—á–∞–µ—Ç `MemoryStorage` –¥–ª—è FSM-—Å–æ—Å—Ç–æ—è–Ω–∏–π
- –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç `LoggingMiddleware` (–ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ Update)
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `/start` ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É ¬´–ù–∞—á–∏–Ω–∞–µ–º! üöÄ¬ª
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç callback `start_forecast` ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç FSM

### `bot/handlers/registration.py` ‚Äî FSM-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫
–ö–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç (FSM) —Å —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏:

```
waiting_for_name
    ‚Üì
waiting_for_birth_date   (—Ñ–æ—Ä–º–∞—Ç: DD.MM.YYYY)
    ‚Üì
waiting_for_birth_time   (—Ñ–æ—Ä–º–∞—Ç: HH:MM)
    ‚Üì
waiting_for_birth_city   (–≥–µ–æ–∫–æ–¥–∏–Ω–≥ –≥–æ—Ä–æ–¥–∞ —Ä–æ–∂–¥–µ–Ω–∏—è)
    ‚Üì
waiting_for_location     (–≥–µ–æ–∫–æ–¥–∏–Ω–≥ —Ç–µ–∫—É—â–µ–≥–æ –≥–æ—Ä–æ–¥–∞)
    ‚Üì
[process_location]       ‚Üê –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
```

**`process_location`** –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ –ø–æ—Ä—è–¥–∫—É:
1. –ì–µ–æ–∫–æ–¥–∏–Ω–≥ —Ç–µ–∫—É—â–µ–≥–æ –≥–æ—Ä–æ–¥–∞
2. –†–∞—Å—á—ë—Ç –õ—É–Ω–∞—Ä–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ (`AstrologyEngine`)
3. –†–∞—Å—á—ë—Ç –¥–æ–º–∏–Ω–∞–Ω—Ç –ø–æ –∑–Ω–∞–∫–∞–º/–¥–æ–º–∞–º (`AstroCalculator`)
4. –û—Ç–ø—Ä–∞–≤–∫–∞ –±–ª–æ–∫–∞ üî¢ –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å—á—ë—Ç–∞
5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PNG-–∫–∞—Ä—Ç—ã –≤ thread executor ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–∞–∫ —Ñ–æ—Ç–æ
6. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞ (`ReportInterpretator`) ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞
7. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∏–Ω–∞–º–∏–∫–∏ ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞
8. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è LLM-–ø—Ä–æ–º—Ç–∞ ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–∞–∫ `.txt` —Ñ–∞–π–ª
9. –ö–Ω–æ–ø–∫–∞ ¬´üîÑ –ù–∞—á–Ω—ë–º –∑–∞–Ω–æ–≤–æ!¬ª

---

### `core/astrology.py` ‚Äî AstrologyEngine
**–ú–µ—Ç–æ–¥ `get_lunar_return(name, year, month, day, hour, minute, lat, lon, utc_offset)`**

–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –í—ã—á–∏—Å–ª—è–µ—Ç –Ω–∞—Ç–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –õ—É–Ω—ã (ephem.Moon)
2. –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–º –ø–æ–∏—Å–∫–æ–º –Ω–∞—Ö–æ–¥–∏—Ç –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –õ—É–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ç—É –∂–µ —ç–∫–ª–∏–ø—Ç–∏—á–µ—Å–∫—É—é –¥–æ–ª–≥–æ—Ç—É
3. –§–æ—Ä–º–∏—Ä—É–µ—Ç `ephem.Observer` –¥–ª—è –º–æ–º–µ–Ω—Ç–∞ –õ—É–Ω–∞—Ä–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞
4. –í—ã–∑—ã–≤–∞–µ—Ç `get_planets_data(observer)` ‚Üí —Å–ø–∏—Å–æ–∫ –ø–ª–∞–Ω–µ—Ç

**–ú–µ—Ç–æ–¥ `get_planets_data(observer)`** ‚Äî –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ 10 –ø–ª–∞–Ω–µ—Ç:
- Sun, Moon, Mercury, Venus, Mars, Jupiter, Saturn, Uranus, Neptune, Pluto
- –í—ã—á–∏—Å–ª—è–µ—Ç —ç–∫–ª–∏–ø—Ç–∏—á–µ—Å–∫—É—é –¥–æ–ª–≥–æ—Ç—É
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞ (—Ü–µ–ª–æ–µ –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ 30¬∞)
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ–º (Whole Sign Houses –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ ASC)
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç **—Ä–µ—Ç—Ä–æ–≥—Ä–∞–¥–Ω–æ—Å—Ç—å**: —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é —Å–µ–π—á–∞—Å –∏ —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞

**–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `_get_asc_sign(observer)` ‚Äî ASC —á–µ—Ä–µ–∑ LST
- `_get_mc_sign(observer)` ‚Äî MC —á–µ—Ä–µ–∑ RAMC
- `get_chart_points(observer)` ‚Üí `{ascendant, midheaven}`

---

### `core/calculator.py` ‚Äî AstroCalculator
–°—á–∏—Ç–∞–µ—Ç **–æ—á–∫–∏ –ø–ª–∞–Ω–µ—Ç** –ø–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º (–û–≥–æ–Ω—å/–ó–µ–º–ª—è/–í–æ–∑–¥—É—Ö/–í–æ–¥–∞) –∏ –∫—Ä–µ—Å—Ç–∞–º (–ö–∞—Ä–¥–∏–Ω–∞–ª—å–Ω—ã–π/–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π/–ú—É—Ç–∞–±–µ–ª—å–Ω—ã–π) ‚Äî –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∑–Ω–∞–∫–æ–≤ –∏ –¥–æ–º–æ–≤. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –∏ –∫—Ä–µ—Å—Ç. –í—ã—á–∏—Å–ª—è–µ—Ç ¬´—Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –∑–Ω–∞–∫¬ª –∏ ¬´—Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –¥–æ–º¬ª.

---

### `core/chart_generator.py` ‚Äî –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–∞—Ä—Ç—ã
–°–æ–∑–¥–∞—ë—Ç PNG (~220 –ö–ë) —Å –∫–æ–ª–µ—Å–æ–º –õ—É–Ω–∞—Ä–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞:

| –≠–ª–µ–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|---------|
| –ó–æ–¥–∏–∞–∫–∞–ª—å–Ω—ã–π –∫—Ä—É–≥ | 12 —Å–µ–∫—Ç–æ—Ä–æ–≤ –ø–æ 30¬∞, —Ü–≤–µ—Ç–∞ –ø–æ —Å—Ç–∏—Ö–∏–∏ (üî¥–û–≥–æ–Ω—å, üü¢–ó–µ–º–ª—è, üü°–í–æ–∑–¥—É—Ö, üîµ–í–æ–¥–∞) |
| –°–∏–º–≤–æ–ª—ã –∑–Ω–∞–∫–æ–≤ | ‚ôà‚ôâ‚ôä‚ôã‚ôå‚ôç‚ôé‚ôè‚ôê‚ôë‚ôí‚ôì |
| 12 –¥–æ–º–æ–≤ | Whole Sign, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏, –Ω–æ–º–µ—Ä–∞ |
| –û—Å–∏ | ASC / IC / DSC / MC |
| –ü–ª–∞–Ω–µ—Ç—ã | –°–∏–º–≤–æ–ª ‚òâ‚òΩ‚òø‚ôÄ‚ôÇ‚ôÉ‚ôÑ‚ôÖ‚ôÜ‚ôá + —Ü–≤–µ—Ç–Ω–∞—è —Ç–æ—á–∫–∞ –Ω–∞ –∫–æ–ª—å—Ü–µ |
| –†–µ—Ç—Ä–æ–≥—Ä–∞–¥–Ω–æ—Å—Ç—å | –ú–∞—Ä–∫–µ—Ä **‚Ñû** —Ä—è–¥–æ–º —Å –ø–ª–∞–Ω–µ—Ç–æ–π |
| –ê—Å–ø–µ–∫—Ç—ã | –õ–∏–Ω–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–ª–µ—Å–∞ –ø–æ 6 –≤–∏–¥–∞–º: |
| | ‚òå –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (0¬∞) ‚Äî –∂—ë–ª—Ç—ã–π |
| | ‚òç –û–ø–ø–æ–∑–∏—Ü–∏—è (180¬∞) ‚Äî –∫—Ä–∞—Å–Ω—ã–π |
| | ‚ñ≥ –¢—Ä–∏–Ω (120¬∞) ‚Äî –∑–µ–ª—ë–Ω—ã–π |
| | ‚ñ° –ö–≤–∞–¥—Ä–∞—Ç (90¬∞) ‚Äî –∫—Ä–∞—Å–Ω—ã–π –ø—É–Ω–∫—Ç–∏—Ä |
| | ‚ú∂ –°–µ–∫—Å—Ç–∏–ª—å (60¬∞) ‚Äî —Å–∏–Ω–∏–π |
| | ‚öª –ö–≤–∏–Ω–∫—É–Ω–∫—Å (150¬∞) ‚Äî —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π |
| –¶–µ–Ω—Ç—Ä | –ò–º—è, –¥–∞—Ç–∞, –≤—Ä–µ–º—è, –≥–æ—Ä–æ–¥ |
| –õ–µ–≥–µ–Ω–¥–∞ | –ü–ª–∞–Ω–µ—Ç—ã + –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ –∞—Å–ø–µ–∫—Ç–æ–≤ |

**–í–∞–∂–Ω–æ:** –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ `asyncio.run_in_executor` (–æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫), —Ç.–∫. matplotlib CPU-–±–ª–æ–∫–∏—Ä—É—é—â–∏–π (~2-60 —Å–µ–∫ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Ä–µ–Ω–¥–µ—Ä–µ).

---

### `core/geocoder.py` ‚Äî –ì–µ–æ–∫–æ–¥–µ—Ä
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **Nominatim** (OpenStreetMap, –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –±–µ–∑ API-–∫–ª—é—á–∞)
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –Ω–∞—Å–µ–ª—ë–Ω–Ω—ã–π –ø—É–Ω–∫—Ç (–Ω–µ —Ä–µ–∫–∞, –Ω–µ –≥–æ—Ä–∞)
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç timezone —á–µ—Ä–µ–∑ **TimezoneFinder** (offline, –ª–æ–∫–∞–ª—å–Ω–∞—è –ë–î)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{lat, lon, timezone_name, utc_offset_hours, display_name}`

---

### `core/interpretator.py` ‚Äî ReportInterpretator
- `generate_report(...)` ‚Äî –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –º–µ—Å—è—Ü (HTML –¥–ª—è Telegram)
- `generate_dynamics_report(...)` ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ –ø–æ –¥–Ω—è–º
- `generate_llm_prompt(...)` ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º—Ç –¥–ª—è ChatGPT/Claude

---

## –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```mermaid
graph TD
    U["üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"] --> |"–∏–º—è, –î–†, –≤—Ä–µ–º—è, 2 –≥–æ—Ä–æ–¥–∞"| FSM
    FSM --> GEO["geocoder.py\nNominatim + TimezoneFinder"]
    GEO --> |"lat, lon, tz"| AE["astrology.py\nAstrologyEngine\nephem"]
    AE --> |"observer"| PD["–ü–æ–∑–∏—Ü–∏–∏ 10 –ø–ª–∞–Ω–µ—Ç\n–∑–Ω–∞–∫, –¥–æ–º, lon_deg, is_retro"]
    PD --> CALC["calculator.py\n–û—á–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤/–∫—Ä–µ—Å—Ç–æ–≤\n–î–æ–º–∏–Ω–∞–Ω—Ç—ã, —Å–∏–Ω—Ç. –∑–Ω–∞–∫"]
    PD --> CG["chart_generator.py\nmatplotlib ‚Üí PNG"]
    CALC --> INTERP["interpretator.py\n–ü—Ä–æ–≥–Ω–æ–∑, –¥–∏–Ω–∞–º–∏–∫–∞, LLM-–ø—Ä–æ–º—Ç"]
    CG --> |"PNG bytes"| TG["Telegram\nanswerPhoto"]
    INTERP --> |"HTML-—Ç–µ–∫—Å—Ç\ntxt-—Ñ–∞–π–ª"| TG
```

---

## FSM-—Å–æ—Å—Ç–æ—è–Ω–∏—è

```python
class RegistrationStates(StatesGroup):
    waiting_for_name        = State()
    waiting_for_birth_date  = State()
    waiting_for_birth_time  = State()
    waiting_for_birth_city  = State()
    waiting_for_location    = State()
```

–•—Ä–∞–Ω–∏–ª–∏—â–µ: **MemoryStorage** (–≤ –ø–∞–º—è—Ç–∏, —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ).
–ù–∞ –ø—Ä–æ–¥–∞–∫—à–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ **Redis** (`aiogram.fsm.storage.redis`).

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### Python (requirements.txt)
```
aiogram==3.17.0            # Telegram Bot API
ephem==4.1.6               # –ê—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—á—ë—Ç—ã (ephemeris)
geopy>=2.4.0               # –ì–µ–æ–∫–æ–¥–∏–Ω–≥ (Nominatim)
timezonefinder>=6.2.0      # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ (offline)
pydantic==2.10.6           # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
python-dotenv==1.0.1       # –ó–∞–≥—Ä—É–∑–∫–∞ .env
pytz==2025.1               # –†–∞–±–æ—Ç–∞ —Å —á–∞—Å–æ–≤—ã–º–∏ –ø–æ—è—Å–∞–º–∏
python-dateutil==2.9.0     # –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç
requests==2.32.3           # HTTP (—Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–æ –¥–ª—è geopy)
matplotlib>=3.10           # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PNG-–∫–∞—Ä—Ç—ã
numpy                      # –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å matplotlib)
```

### –°–∏—Å—Ç–µ–º–Ω—ã–µ (Linux/Docker)
```
# –î–ª—è matplotlib (–æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –±–µ–∑ –¥–∏—Å–ø–ª–µ—è):
libgl1              # OpenGL (–∏–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ)

# –®—Ä–∏—Ñ—Ç—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ Unicode-—Å–∏–º–≤–æ–ª–æ–≤ ‚ôà‚ôâ‚òâ‚òΩ:
fonts-dejavu-core   # –∏–ª–∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç
```

### –í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã
| –°–µ—Ä–≤–∏—Å | –ó–∞—á–µ–º | –ö–ª—é—á |
|--------|-------|------|
| Telegram Bot API | –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π | BOT_TOKEN |
| Nominatim (OSM) | –ì–µ–æ–∫–æ–¥–∏–Ω–≥ –≥–æ—Ä–æ–¥–æ–≤ | –ù–µ –Ω—É–∂–µ–Ω (rate limit: 1 req/sec) |

> [!NOTE]
> **Ephem**, **TimezoneFinder** –∏ **matplotlib** —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ñ–ª–∞–π–Ω.
